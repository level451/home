<!DOCTYPE html>
<html lang="en">
<head>
    <title>MC Login</title>
    <link rel="icon" href="images/favicon.ico" type="image/ico" sizes="16x16">
    <meta name="viewport" content="width=device-width, initial-scale=1" >
    <link rel="stylesheet" href="./stylesheets/main.css">
    <link rel="stylesheet" href="./stylesheets/login.css">
</head>
<body>
<%- include("theme/"+localSettings.theme.theme+"/header")%>

<div class="form">
    <form method="POST" action="/login">

    <h2 class="heading"><%=pageName%></h2>
    <br>

        <input type="text" id="name" name="userName" placeholder="User name..">
        <input type="text" id="code" name="authenticationCode" placeholder="Access code..">
        <input type="submit" value="Submit">
        <input type="text" id="localIp" name="localIp" >
    </form>
</div>
</body>

</html>
<script>

    window.RTCPeerConnection = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection;//compatibility for Firefox and chrome
    var pc = new RTCPeerConnection({iceServers:[]}), noop = function(){};
    pc.createDataChannel('');//create a bogus data channel
    pc.createOffer(pc.setLocalDescription.bind(pc), noop);// create offer and set local description
    pc.onicecandidate = function(ice)
    {
        console.log(ice)
        if (ice && ice.candidate && ice.candidate.candidate)
        {
            document.getElementById('localIp').value  = /([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/.exec(ice.candidate.candidate)[1];
            pc.onicecandidate = noop;
            document.getElementById('localIp').value
        }
    };
</script>